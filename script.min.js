mapboxgl.accessToken='pk.eyJ1IjoiaW50ZXJuYXRpb25hbHNvcyIsImEiOiJjamo1cDNpOWsxdnB2M3BzMjAzNWk1b2FoIn0.49i92ZK8WKifgkSEKtDB7Q';var map;function initMap(){map=new mapboxgl.Map({container:'map',style:'mapbox://styles/mapbox/streets-v9',zoom:2})}function addLayerToMapbox(c,d,f,g,h,j,k,l){for(var n,m=map.getStyle().layers,o=0;o<m.length;o++)if('symbol'===m[o].type){n=m[o].id;break}var p='',q=[],r=[];0<d.length?(d.forEach(function(s){q.push(s.Latitude),q.push(s.Longitude)}),r=q):p=f,map.addLayer({id:c,type:'fill',source:{type:'geojson',data:{type:'Feature',geometry:{type:g,coordinates:d}}},layout:{},paint:{'fill-color':h,'fill-opacity':j}},n),[0,0]!=k&&map.addLayer({id:c+k,type:'line',source:{type:'geojson',data:{type:'Feature',geometry:{type:g,coordinates:d}}},layout:{},paint:{'line-color':l,'line-width':1,'line-dasharray':k}})}function locationGetCoordinatesAndBounds(c){var d={MaxLat:null,MinLat:null,MaxLon:null,MinLon:null},f=JSON.stringify(c);f=f.replace(/\[\[\[/g,'['),f=f.replace(/\[\[/g,'['),f=f.replace(/\]\]\]/g,']'),f=f.replace(/\]\]/g,']'),f=f.replace(/\[/g,'{"Lat":'),f=f.replace(/\]\,/g,'#'),f=f.replace(/\,/g,',"Lon":'),f=f.replace(/\#/g,'},'),f=f.replace(/\]/g,'}'),f='['+f+']';var f=JSON.parse(JSON.stringify(f)),g=JSON.parse(f);return g.sort(sortLatitude),d.MinLat=g[0].Lat,d.MaxLat=g[g.length-1].Lat,g.sort(sortLongitude),d.MinLon=g[0].Lon,d.MaxLon=g[g.length-1].Lon,d}function expandBounds(c,d,f){var g={MaxLat:null,MinLat:null,MaxLon:null,MinLon:null};return!0===f?g=d:(g.MaxLat=c.MaxLat>=d.MaxLat?c.MaxLat:d.MaxLat,g.MaxLon=c.MaxLon>=d.MaxLon?c.MaxLon:d.MaxLon,g.MinLat=c.MinLat>=d.MinLat?c.MinLat:d.MinLat,g.MinLon=c.MinLon>=d.MinLon?c.MinLon:d.MinLon),g}function addImageLayerToMapbox(c,d,f,g){var h='',j=[];0<d.length?d.forEach(function(k){h+=h+'['+k.Latitude+','+k.Longitude+'],',j.push(k.Latitude),j.push(k.Longitude)}):h=f,console.log(j),map.loadImage(g,function(k,l){map.addImage(c,l),map.addLayer({id:c,type:'symbol',source:{type:'geojson',data:{type:'FeatureCollection',features:[{type:'Feature',geometry:{type:'Point',coordinates:j}}]}},layout:{'icon-image':c,'icon-size':0.4}})})}function addRadiusLayerToMapbox(c,d,f,g,h,j,k){var l=[];l.push(h),l.push(g),console.log('radius layer start'),console.log('createGeoJsonCircle'),console.log(l[0]),console.log(l[1]),console.log(f),console.log(createGeoJSONCircle(l,f)),map.addSource(c,createGeoJSONCircle(l,f));for(var n,m=map.getStyle().layers,o=0;o<m.length;o++)if(console.log(m[o].type),'symbol'===m[o].type){n=m[o].id;break}console.log(n),console.log(c),map.addLayer({id:c,type:'fill',source:c,layout:{},paint:{'fill-color':j,'fill-opacity':k}})}function addPopupOnClick(c,d,f,g,h,j){var k=[c],l=[];l.push(d),l.push(f),map.on('click',function(m){var n=map.queryRenderedFeatures(m.point,{layers:k});if(n.length){var o=n[0],p='';p=''==j?'display:none':'';new mapboxgl.Popup({className:'mapbox-bg-High'}).setLngLat(l).setHTML('<div>').setHTML('<a href='+g+'>').setHTML('<p><b>'+h+'</b></p>').setHTML('</a>').setHTML('<p style='+p+'>'+j+'</p>').setHTML('</div>').setLngLat(l).addTo(map)}})}var createGeoJSONCircle=function(c,d,f){f||(f=64);for(var n,o,p,g={latitude:c[1],longitude:c[0]},h=d,j=[],k=[],l=h/(111.32*Math.cos(g.latitude*Math.PI/180)),q=0;q<f;q++)n=q/f*(2*Math.PI),o=l*Math.cos(n),p=h/110.574*Math.sin(n),j.push([g.longitude+o,g.latitude+p]);return j.push(j[0]),k.push(j),{type:'geojson',data:{type:'FeatureCollection',features:[{type:'Feature',geometry:{type:'Polygon',coordinates:k}}]}}};function sortLatitude(c,d){return c.Lat<d.Lat?-1:c.Lat>d.Lat?1:0}function sortLongitude(c,d){return c.Lon<d.Lon?-1:c.Lon>d.Lon?1:0}function calculateBounds(c,d){var f=0,g=0,h=parseFloat(d);if(0!=h){var j=Math.cos(3.141592654*c.Latitude/180);f=Math.abs(h/(111.32*j)),g=h/110.574}return{MaxLat:c.Latitude+g,MaxLong:c.Longtitude+f,MinLat:c.Latitude-g,MinLong:c.Longtitude-f}}